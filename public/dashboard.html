<!doctype html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>I Miei Tips — WinningBet</title>
    <meta
      name="description"
      content="La tua area personale WinningBet. Pronostici, storico e gestione abbonamento."
    />
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />

    <!-- Open Graph -->
    <meta property="og:title" content="I Miei Tips — WinningBet" />
    <meta
      property="og:description"
      content="La tua area personale WinningBet. Pronostici, storico e gestione abbonamento."
    />
    <meta property="og:image" content="https://winningbet.it/og-image.png" />
    <meta property="og:url" content="https://winningbet.it/dashboard.html" />
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="it_IT" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="I Miei Tips — WinningBet" />
    <meta
      name="twitter:description"
      content="La tua area personale WinningBet. Pronostici, storico e gestione abbonamento."
    />
    <meta name="twitter:image" content="https://winningbet.it/og-image.png" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar scrolled" id="navbar">
      <div class="container nav-content">
        <a href="/" class="logo">
          <span class="logo-icon">&#9824;</span>
          <span class="logo-text">WinningBet</span>
        </a>
        <div class="nav-links" id="navLinks">
          <a href="/#tips" data-i18n="nav.tips">Tips</a>
          <a href="/#stats" data-i18n="nav.track">Track Record</a>
          <a href="/#pricing" data-i18n="nav.plans">Piani</a>
          <a href="/#faq" data-i18n="nav.faq">FAQ</a>
          <button class="lang-toggle" id="langToggle" title="Cambia lingua">
            <span class="flag-emoji">&#127470;&#127481;</span>
            <span class="lang-label" aria-hidden="true"></span>
          </button>
          <a href="#" class="btn btn-outline btn-sm" id="logoutBtn">Esci</a>
        </div>
        <!-- Notification bell -->
        <div class="dash-notif-bell" id="notifBell" style="display: none">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9" />
            <path d="M13.73 21a2 2 0 01-3.46 0" />
          </svg>
          <span class="notif-badge" id="notifCount" style="display: none">0</span>
        </div>
        <button class="hamburger" id="hamburger" aria-label="Menu">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
    </nav>

    <!-- Notification dropdown -->
    <div class="notif-dropdown" id="notifDropdown" style="display: none">
      <div class="notif-dropdown-header">
        <span>Notifiche</span>
        <button class="notif-mark-all" id="notifMarkAll">Segna tutte lette</button>
      </div>
      <div class="notif-dropdown-list" id="notifList"></div>
    </div>

    <!-- Dashboard Content -->
    <main class="dash-main">
      <!-- Pull-to-refresh indicator -->
      <div class="ptr-indicator" id="ptrIndicator">
        <span class="loading-spinner"></span>
      </div>

      <div class="container">
        <!-- Welcome header -->
        <div class="dash-header" id="dashHeader">
          <div class="dash-welcome">
            <h1 class="dash-title">
              Ciao, <span class="text-gradient" id="userName">&mdash;</span>
            </h1>
            <p class="dash-subtitle">Ecco i tuoi pronostici e le tue statistiche.</p>
          </div>
          <div class="dash-header-right">
            <!-- Activity stats -->
            <div class="dash-activity-stats" id="activityStats" style="display: none">
              <div class="activity-stat" title="Visite totali">
                <span class="activity-stat-icon">&#128200;</span>
                <span class="activity-stat-value" id="totalVisits">0</span>
              </div>
              <div class="activity-stat" title="Record serie consecutiva">
                <span class="activity-stat-icon">&#127942;</span>
                <span class="activity-stat-value" id="longestStreak">0</span>
              </div>
            </div>
            <!-- Streak display -->
            <div class="dash-streak" id="streakDisplay" style="display: none">
              <span class="streak-flame">&#128293;</span>
              <span class="streak-count" id="streakCount">0</span>
            </div>
            <div class="dash-tier-badge" id="tierBadge">
              <span class="tier-label" id="tierLabel">FREE</span>
            </div>
            <!-- Settings gear icon -->
            <button class="dash-settings-btn" id="settingsBtn" aria-label="Impostazioni">
              <svg
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="1.5"
              >
                <circle cx="12" cy="12" r="3" />
                <path
                  d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z"
                />
              </svg>
            </button>
          </div>
        </div>

        <!-- Checkout feedback -->
        <div class="dash-alert" id="checkoutAlert" style="display: none"></div>

        <!-- Streak celebration -->
        <div class="streak-celebration" id="streakCelebration" style="display: none">
          <span class="streak-celebration-text" id="streakCelebrationText"></span>
        </div>

        <!-- League selector -->
        <div class="dash-league-selector" id="dashLeagueSelector">
          <div class="league-selector">
            <button class="league-btn" data-league="all">Tutte</button>
            <button class="league-btn active" data-league="serie-a">Serie A</button>
            <button class="league-btn" data-league="champions-league">UCL</button>
            <button class="league-btn" data-league="la-liga">La Liga</button>
            <button class="league-btn" data-league="premier-league">PL</button>
            <button class="league-btn" data-league="ligue-1">Ligue 1</button>
            <button class="league-btn" data-league="bundesliga">Bundesliga</button>
            <button class="league-btn" data-league="eredivisie">Eredivisie</button>
          </div>
        </div>

        <!-- Tab navigation -->
        <div class="dash-tabs" role="tablist" aria-label="Sezioni dashboard">
          <button
            class="dash-tab active"
            data-tab="tips"
            role="tab"
            aria-selected="true"
            aria-controls="panelTips"
            id="tabTips"
          >
            Tips di Oggi
          </button>
          <button
            class="dash-tab"
            data-tab="schedine"
            role="tab"
            aria-selected="false"
            aria-controls="panelSchedule"
            id="tabSchedine"
          >
            Schedine
          </button>
          <button
            class="dash-tab"
            data-tab="history"
            role="tab"
            aria-selected="false"
            aria-controls="panelHistory"
            id="tabHistory"
          >
            Storico
          </button>
        </div>

        <!-- TAB: Today's Tips -->
        <section class="dash-panel" id="panelTips" role="tabpanel" aria-labelledby="tabTips">
          <div
            class="dash-tips-grid"
            id="dashTipsGrid"
            aria-live="polite"
            aria-label="Pronostici di oggi"
          >
            <div class="skeleton skeleton-card" aria-hidden="true"></div>
            <div class="skeleton skeleton-card" aria-hidden="true"></div>
            <div class="skeleton skeleton-card" aria-hidden="true"></div>
          </div>
          <div class="dash-tips-empty" id="dashTipsEmpty" style="display: none">
            <svg
              width="48"
              height="48"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <circle cx="12" cy="12" r="10" />
              <path d="M12 6v6l4 2" />
            </svg>
            <p>Nessun pronostico disponibile per oggi.</p>
            <p class="dash-tips-empty-sub">
              I nuovi tips vengono pubblicati prima di ogni giornata.
            </p>
            <!-- Countdown -->
            <div class="tips-countdown" id="tipsCountdown" style="display: none">
              <span class="countdown-label">Prossimi pronostici tra:</span>
              <span class="countdown-value" id="countdownValue">--:--</span>
            </div>
          </div>
        </section>

        <!-- TAB: Schedine (Betting Slips) -->
        <section
          class="dash-panel"
          id="panelSchedule"
          role="tabpanel"
          aria-labelledby="tabSchedine"
          style="display: none"
        >
          <!-- Budget summary bar -->
          <div class="schedine-budget-bar" id="schedineBudgetBar" style="display: none">
            <div class="budget-stat">
              <span class="budget-stat-label">Budget</span>
              <span class="budget-stat-value" id="budgetTotal">&mdash;</span>
            </div>
            <div class="budget-stat">
              <span class="budget-stat-label">Investito</span>
              <span class="budget-stat-value budget-stat-value--stake" id="budgetStake"
                >&mdash;</span
              >
            </div>
            <div class="budget-stat">
              <span class="budget-stat-label">Riserva</span>
              <span class="budget-stat-value budget-stat-value--reserve" id="budgetReserve"
                >&mdash;</span
              >
            </div>
          </div>
          <!-- Date picker -->
          <div class="schedine-date-row">
            <button class="schedine-date-nav" id="schedinePrev" aria-label="Settimana precedente">
              &larr;
            </button>
            <span class="schedine-date-label" id="schedineDateLabel">Questa settimana</span>
            <button class="schedine-date-nav" id="schedineNext" aria-label="Settimana successiva">
              &rarr;
            </button>
          </div>
          <!-- Schedine cards -->
          <div
            class="schedine-grid"
            id="schedineGrid"
            aria-live="polite"
            aria-label="Schedine della settimana"
          >
            <div class="skeleton skeleton-card" aria-hidden="true"></div>
            <div class="skeleton skeleton-card" aria-hidden="true"></div>
          </div>
          <!-- Empty state -->
          <div class="schedine-empty" id="schedineEmpty" style="display: none">
            <svg
              width="48"
              height="48"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="1.5"
            >
              <rect x="2" y="3" width="20" height="18" rx="2" />
              <path d="M8 7h8M8 11h5M8 15h8" />
            </svg>
            <p>Nessuna schedina disponibile per questa data.</p>
            <p class="schedine-empty-sub">
              Le schedine vengono generate dopo i pronostici giornalieri.
            </p>
          </div>
          <!-- Tier upgrade prompt for free users -->
          <div class="schedine-upgrade" id="schedineUpgrade" style="display: none">
            <svg
              width="48"
              height="48"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="1.5"
            >
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
              <path d="M7 11V7a5 5 0 0110 0v4" />
            </svg>
            <h3>Schedine Intelligenti</h3>
            <p>
              Le schedine intelligenti con stake ottimizzati sono disponibili per abbonati PRO e
              VIP.
            </p>
            <button class="btn btn-gold btn-sm" id="schedineUpgradeBtn">Passa a PRO</button>
          </div>
        </section>

        <!-- TAB: History -->
        <section
          class="dash-panel"
          id="panelHistory"
          role="tabpanel"
          aria-labelledby="tabHistory"
          style="display: none"
        >
          <div class="dash-history-filters">
            <button class="filter-btn active" data-status="all">Tutti</button>
            <button class="filter-btn" data-status="won">Vinti</button>
            <button class="filter-btn" data-status="lost">Persi</button>
            <button class="filter-btn" data-status="pending">In Corso</button>
            <button class="filter-btn" data-status="favorites">Preferiti</button>
          </div>
          <!-- Dashboard chart -->
          <div class="dash-chart-container" id="dashChartContainer" style="display: none">
            <div class="chart-title">Profitto Mensile</div>
            <div class="chart dash-chart" id="dashChart"></div>
          </div>
          <div
            class="dash-history-list"
            id="dashHistoryList"
            aria-live="polite"
            aria-label="Storico pronostici"
          >
            <div class="skeleton skeleton-history" aria-hidden="true"></div>
            <div class="skeleton skeleton-history" aria-hidden="true"></div>
            <div class="skeleton skeleton-history" aria-hidden="true"></div>
          </div>
          <div class="dash-history-empty" id="dashHistoryEmpty" style="display: none">
            <svg
              width="48"
              height="48"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
              <polyline points="14 2 14 8 20 8" />
            </svg>
            <p>Nessun risultato trovato.</p>
          </div>
        </section>

        <!-- TAB: Account -->
        <section class="dash-panel" id="panelAccount" style="display: none">
          <!-- Profile Hero Banner -->
          <div class="profile-hero">
            <div class="profile-hero__glow"></div>
            <div class="profile-hero__content">
              <div class="profile-hero__avatar" id="userAvatar">
                <span class="profile-hero__initials" id="userInitials">?</span>
              </div>
              <div class="profile-hero__info">
                <h2 class="profile-hero__name" id="userDisplayName">&mdash;</h2>
                <p class="profile-hero__email" id="userEmail">&mdash;</p>
                <div class="profile-hero__meta">
                  <span class="profile-hero__badge" id="subTierBadge">FREE</span>
                  <span class="profile-hero__since"
                    >Membro dal <span id="userSince">&mdash;</span></span
                  >
                </div>
              </div>
            </div>
          </div>

          <!-- Subscription Status (hidden elements for JS compat) -->
          <span id="subTier" style="display: none">Free</span>
          <span id="subStatus" style="display: none">&mdash;</span>
          <div id="subRenewalRow" style="display: none"><span id="subRenewal">&mdash;</span></div>

          <!-- Upgrade Plans -->
          <div class="upgrade-section" id="upgradeSection">
            <h3 class="upgrade-section__title">Sblocca il tuo potenziale</h3>
            <div class="upgrade-plans">
              <div class="upgrade-card upgrade-card--pro">
                <div class="upgrade-card__header">
                  <span class="upgrade-card__tier">PRO</span>
                  <span class="upgrade-card__popular">Consigliato</span>
                </div>
                <div class="upgrade-card__price" data-tier="pro">
                  <span class="upgrade-card__currency">&euro;</span>
                  <span class="upgrade-card__amount">9</span>
                  <span class="upgrade-card__decimal">.99</span>
                  <span class="upgrade-card__period">/mese</span>
                </div>
                <ul class="upgrade-card__features">
                  <li>Tips PRO multi-lega</li>
                  <li>Analisi pre-partita</li>
                  <li>Schedine settimanali</li>
                  <li>Storico completo</li>
                </ul>
                <button class="upgrade-card__btn" id="upgradeProBtn">Scegli PRO</button>
              </div>
              <div class="upgrade-card upgrade-card--vip">
                <div class="upgrade-card__header">
                  <span class="upgrade-card__tier">VIP</span>
                </div>
                <div class="upgrade-card__price" data-tier="vip">
                  <span class="upgrade-card__currency">&euro;</span>
                  <span class="upgrade-card__amount">29</span>
                  <span class="upgrade-card__decimal">.99</span>
                  <span class="upgrade-card__period">/mese</span>
                </div>
                <ul class="upgrade-card__features">
                  <li>Tutto del piano PRO</li>
                  <li>Tips VALUE esclusivi</li>
                  <li>Canale Telegram VIP</li>
                  <li>Supporto diretto 1-to-1</li>
                </ul>
                <button class="upgrade-card__btn" id="upgradeVipBtn">Diventa VIP</button>
              </div>
            </div>
            <!-- Hidden compat elements -->
            <button id="upgradeBtn" style="display: none"></button>
            <div id="upgradePicker" style="display: none"></div>
          </div>

          <!-- Manage subscription (shown when user has active sub) -->
          <div class="manage-sub-row" id="manageSubRow" style="display: none">
            <div class="manage-sub-row__info">
              <span class="manage-sub-row__status" id="subStatusDisplay">Attivo</span>
              <span class="manage-sub-row__renewal" id="subRenewalDisplay"></span>
            </div>
            <button class="btn btn-outline" id="manageSubBtn" style="display: none">
              Gestisci Abbonamento
            </button>
          </div>

          <div class="dash-account-grid">
            <!-- Telegram linking card -->
            <div class="dash-account-card">
              <h3 class="dash-card-title">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <path
                    d="M21.198 2.433a2.242 2.242 0 0 0-1.022.215l-16.5 7.5a2.25 2.25 0 0 0 .126 4.16l4.5 1.5 1.5 4.5a2.25 2.25 0 0 0 4.16.126l7.5-16.5a2.242 2.242 0 0 0-0.264-1.501z"
                  />
                </svg>
                Telegram
              </h3>
              <div class="dash-telegram-info">
                <p class="dash-telegram-status" id="telegramStatus">Verifica in corso...</p>
              </div>
              <div class="dash-sub-actions">
                <button
                  class="btn btn-telegram btn-block"
                  id="linkTelegramBtn"
                  style="display: none"
                >
                  Collega Telegram
                </button>
              </div>
            </div>

            <!-- Preferences card -->
            <div class="dash-account-card">
              <h3 class="dash-card-title">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <circle cx="12" cy="12" r="3" />
                  <path
                    d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z"
                  />
                </svg>
                Preferenze
              </h3>
              <!-- Favorite teams -->
              <div class="pref-section">
                <label class="pref-label">Squadre preferite</label>
                <div class="team-selector">
                  <input
                    type="text"
                    class="team-search-input"
                    id="teamSearchInput"
                    placeholder="Cerca squadra..."
                    autocomplete="off"
                  />
                  <div
                    class="team-search-dropdown"
                    id="teamSearchDropdown"
                    style="display: none"
                  ></div>
                </div>
                <div class="team-chips" id="teamChips"></div>
              </div>
              <!-- Risk Profile -->
              <div class="pref-section">
                <label class="pref-label">Profilo di Rischio</label>
                <div class="pref-field-row">
                  <span class="pref-field-label">Tolleranza rischio</span>
                  <select class="pref-select" id="prefRiskTolerance">
                    <option value="prudente">Prudente</option>
                    <option value="equilibrato" selected>Equilibrato</option>
                    <option value="aggressivo">Aggressivo</option>
                  </select>
                </div>
                <div class="pref-field-row">
                  <span class="pref-field-label">Budget settimanale</span>
                  <div class="pref-input-group">
                    <input
                      type="number"
                      class="pref-input"
                      id="prefWeeklyBudget"
                      min="5"
                      max="10000"
                      step="5"
                      value="50"
                    />
                    <span class="pref-input-suffix">&euro;</span>
                  </div>
                </div>
                <div class="pref-field-row">
                  <span class="pref-field-label">Max schedine/giorno</span>
                  <select class="pref-select" id="prefMaxSchedine">
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3" selected>3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                </div>
              </div>
              <!-- Notification toggles -->
              <div class="pref-section">
                <label class="pref-label">Notifiche</label>
                <div class="pref-toggle-row">
                  <span>Nuovi tips</span>
                  <label class="toggle-switch">
                    <input type="checkbox" id="prefNotifTips" checked />
                    <span class="toggle-slider"></span>
                  </label>
                </div>
                <div class="pref-toggle-row">
                  <span>Risultati</span>
                  <label class="toggle-switch">
                    <input type="checkbox" id="prefNotifResults" checked />
                    <span class="toggle-slider"></span>
                  </label>
                </div>
              </div>
              <div class="pref-save-status" id="prefSaveStatus"></div>
            </div>
          </div>
        </section>
      </div>
    </main>

    <!-- Footer minimal -->
    <footer class="footer dash-footer">
      <div class="container">
        <div class="footer-copy">
          <span>&copy; 2026 WinningBet. Tutti i diritti riservati.</span>
          <div class="footer-age">
            <span class="age-badge">18+</span>
            <span>ADM</span>
          </div>
        </div>
      </div>
    </footer>

    <!-- Supabase CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
    <script src="supabase-config.js"></script>
    <script src="i18n.js"></script>
    <script src="shared.js"></script>
    <script src="dashboard-renderers.js"></script>
    <script src="dashboard.js"></script>
  </body>
</html>
