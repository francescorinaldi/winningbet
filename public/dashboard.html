<!doctype html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard â€” WinningBet</title>
    <meta
      name="description"
      content="La tua area personale WinningBet. Pronostici, storico e gestione abbonamento."
    />
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />

    <!-- Supabase config -->
    <meta name="supabase-url" content="https://xqrxfnovlukbbuvhbavj.supabase.co" />
    <meta
      name="supabase-anon-key"
      content="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inhxcnhmbm92bHVrYmJ1dmhiYXZqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAzMjczNTYsImV4cCI6MjA4NTkwMzM1Nn0.M9IJED7_yoNdRDf3yjwULxWqIlgO1FTEwhHFNBpULSg"
    />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!-- Particle background -->
    <canvas id="particles"></canvas>

    <!-- Navbar -->
    <nav class="navbar scrolled" id="navbar">
      <div class="container nav-content">
        <a href="/" class="logo">
          <span class="logo-icon">&#9824;</span>
          <span class="logo-text">WinningBet</span>
        </a>
        <div class="nav-links" id="navLinks">
          <a href="/#tips">Tips</a>
          <a href="/#stats">Track Record</a>
          <a href="/#pricing">Piani</a>
          <a href="/#faq">FAQ</a>
          <a href="#" class="btn btn-outline btn-sm" id="logoutBtn">Esci</a>
        </div>
        <!-- Notification bell -->
        <div class="dash-notif-bell" id="notifBell" style="display: none">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9" />
            <path d="M13.73 21a2 2 0 01-3.46 0" />
          </svg>
          <span class="notif-badge" id="notifCount" style="display: none">0</span>
        </div>
        <button class="hamburger" id="hamburger" aria-label="Menu">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
    </nav>

    <!-- Notification dropdown -->
    <div class="notif-dropdown" id="notifDropdown" style="display: none">
      <div class="notif-dropdown-header">
        <span>Notifiche</span>
        <button class="notif-mark-all" id="notifMarkAll">Segna tutte lette</button>
      </div>
      <div class="notif-dropdown-list" id="notifList"></div>
    </div>

    <!-- Dashboard Content -->
    <main class="dash-main">
      <!-- Pull-to-refresh indicator -->
      <div class="ptr-indicator" id="ptrIndicator">
        <span class="loading-spinner"></span>
      </div>

      <div class="container">
        <!-- Welcome header -->
        <div class="dash-header" id="dashHeader">
          <div class="dash-welcome">
            <h1 class="dash-title">
              Ciao, <span class="text-gradient" id="userName">&mdash;</span>
            </h1>
            <p class="dash-subtitle">Ecco i tuoi pronostici e le tue statistiche.</p>
          </div>
          <div class="dash-header-right">
            <!-- Streak display -->
            <div class="dash-streak" id="streakDisplay" style="display: none">
              <span class="streak-flame">&#128293;</span>
              <span class="streak-count" id="streakCount">0</span>
            </div>
            <div class="dash-tier-badge" id="tierBadge">
              <span class="tier-label" id="tierLabel">FREE</span>
            </div>
          </div>
        </div>

        <!-- Checkout feedback -->
        <div class="dash-alert" id="checkoutAlert" style="display: none"></div>

        <!-- Streak celebration -->
        <div class="streak-celebration" id="streakCelebration" style="display: none">
          <span class="streak-celebration-text" id="streakCelebrationText"></span>
        </div>

        <!-- League selector -->
        <div class="dash-league-selector" id="dashLeagueSelector">
          <div class="league-selector">
            <button class="league-btn active" data-league="serie-a">Serie A</button>
            <button class="league-btn" data-league="champions-league">UCL</button>
            <button class="league-btn" data-league="la-liga">La Liga</button>
            <button class="league-btn" data-league="premier-league">PL</button>
          </div>
        </div>

        <!-- Tab navigation -->
        <div class="dash-tabs">
          <button class="dash-tab active" data-tab="tips">Tips di Oggi</button>
          <button class="dash-tab" data-tab="history">Storico</button>
          <button class="dash-tab" data-tab="account">Account</button>
        </div>

        <!-- TAB: Today's Tips -->
        <section class="dash-panel" id="panelTips">
          <div class="dash-tips-grid" id="dashTipsGrid">
            <div class="tips-loading">
              <span class="loading-spinner"></span>
              <span>Caricamento pronostici...</span>
            </div>
          </div>
          <div class="dash-tips-empty" id="dashTipsEmpty" style="display: none">
            <svg
              width="48"
              height="48"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <circle cx="12" cy="12" r="10" />
              <path d="M12 6v6l4 2" />
            </svg>
            <p>Nessun pronostico disponibile per oggi.</p>
            <p class="dash-tips-empty-sub">
              I nuovi tips vengono pubblicati prima di ogni giornata.
            </p>
            <!-- Countdown -->
            <div class="tips-countdown" id="tipsCountdown" style="display: none">
              <span class="countdown-label">Prossimi pronostici tra:</span>
              <span class="countdown-value" id="countdownValue">--:--</span>
            </div>
          </div>
        </section>

        <!-- TAB: History -->
        <section class="dash-panel" id="panelHistory" style="display: none">
          <div class="dash-history-filters">
            <button class="filter-btn active" data-status="all">Tutti</button>
            <button class="filter-btn" data-status="won">Vinti</button>
            <button class="filter-btn" data-status="lost">Persi</button>
            <button class="filter-btn" data-status="pending">In Corso</button>
            <button class="filter-btn" data-status="favorites">Preferiti</button>
          </div>
          <!-- Dashboard chart -->
          <div class="dash-chart-container" id="dashChartContainer" style="display: none">
            <div class="chart-title">Profitto Mensile</div>
            <div class="chart dash-chart" id="dashChart"></div>
          </div>
          <div class="dash-history-list" id="dashHistoryList">
            <div class="tips-loading">
              <span class="loading-spinner"></span>
              <span>Caricamento storico...</span>
            </div>
          </div>
          <div class="dash-history-empty" id="dashHistoryEmpty" style="display: none">
            <svg
              width="48"
              height="48"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
              <polyline points="14 2 14 8 20 8" />
            </svg>
            <p>Nessun risultato trovato.</p>
          </div>
        </section>

        <!-- TAB: Account -->
        <section class="dash-panel" id="panelAccount" style="display: none">
          <div class="dash-account-grid">
            <!-- Subscription card -->
            <div class="dash-account-card">
              <h3 class="dash-card-title">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <rect x="1" y="4" width="22" height="16" rx="2" ry="2" />
                  <line x1="1" y1="10" x2="23" y2="10" />
                </svg>
                Abbonamento
              </h3>
              <div class="dash-sub-info" id="subInfo">
                <div class="dash-sub-row">
                  <span class="dash-sub-label">Piano attuale</span>
                  <span class="dash-sub-value" id="subTier">Free</span>
                </div>
                <div class="dash-sub-row">
                  <span class="dash-sub-label">Stato</span>
                  <span class="dash-sub-value" id="subStatus">&mdash;</span>
                </div>
                <div class="dash-sub-row" id="subRenewalRow" style="display: none">
                  <span class="dash-sub-label">Prossimo rinnovo</span>
                  <span class="dash-sub-value" id="subRenewal">&mdash;</span>
                </div>
              </div>
              <div class="dash-sub-actions">
                <button class="btn btn-gold btn-block" id="upgradeBtn">Passa a PRO</button>
                <button class="btn btn-outline btn-block" id="manageSubBtn" style="display: none">
                  Gestisci Abbonamento
                </button>
              </div>
            </div>

            <!-- Account info card -->
            <div class="dash-account-card">
              <h3 class="dash-card-title">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                  <circle cx="12" cy="7" r="4" />
                </svg>
                Profilo
              </h3>
              <div class="dash-profile-info">
                <div class="dash-sub-row">
                  <span class="dash-sub-label">Email</span>
                  <span class="dash-sub-value" id="userEmail">&mdash;</span>
                </div>
                <div class="dash-sub-row">
                  <span class="dash-sub-label">Nome</span>
                  <span class="dash-sub-value" id="userDisplayName">&mdash;</span>
                </div>
                <div class="dash-sub-row">
                  <span class="dash-sub-label">Membro dal</span>
                  <span class="dash-sub-value" id="userSince">&mdash;</span>
                </div>
              </div>
            </div>

            <!-- Telegram linking card -->
            <div class="dash-account-card">
              <h3 class="dash-card-title">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <path
                    d="M21.198 2.433a2.242 2.242 0 0 0-1.022.215l-16.5 7.5a2.25 2.25 0 0 0 .126 4.16l4.5 1.5 1.5 4.5a2.25 2.25 0 0 0 4.16.126l7.5-16.5a2.242 2.242 0 0 0-0.264-1.501z"
                  />
                </svg>
                Telegram
              </h3>
              <div class="dash-telegram-info">
                <p class="dash-telegram-status" id="telegramStatus">Verifica in corso...</p>
              </div>
              <div class="dash-sub-actions">
                <button
                  class="btn btn-telegram btn-block"
                  id="linkTelegramBtn"
                  style="display: none"
                >
                  Collega Telegram
                </button>
              </div>
            </div>

            <!-- Preferences card -->
            <div class="dash-account-card">
              <h3 class="dash-card-title">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <circle cx="12" cy="12" r="3" />
                  <path
                    d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z"
                  />
                </svg>
                Preferenze
              </h3>
              <!-- Favorite teams -->
              <div class="pref-section">
                <label class="pref-label">Squadre preferite</label>
                <div class="team-selector">
                  <input
                    type="text"
                    class="team-search-input"
                    id="teamSearchInput"
                    placeholder="Cerca squadra..."
                    autocomplete="off"
                  />
                  <div
                    class="team-search-dropdown"
                    id="teamSearchDropdown"
                    style="display: none"
                  ></div>
                </div>
                <div class="team-chips" id="teamChips"></div>
              </div>
              <!-- Notification toggles -->
              <div class="pref-section">
                <label class="pref-label">Notifiche</label>
                <div class="pref-toggle-row">
                  <span>Nuovi tips</span>
                  <label class="toggle-switch">
                    <input type="checkbox" id="prefNotifTips" checked />
                    <span class="toggle-slider"></span>
                  </label>
                </div>
                <div class="pref-toggle-row">
                  <span>Risultati</span>
                  <label class="toggle-switch">
                    <input type="checkbox" id="prefNotifResults" checked />
                    <span class="toggle-slider"></span>
                  </label>
                </div>
              </div>
              <div class="pref-save-status" id="prefSaveStatus"></div>
            </div>
          </div>
        </section>
      </div>
    </main>

    <!-- Footer minimal -->
    <footer class="footer dash-footer">
      <div class="container">
        <div class="footer-copy">
          <span>&copy; 2026 WinningBet. Tutti i diritti riservati.</span>
          <div class="footer-age">
            <span class="age-badge">18+</span>
            <span>ADM</span>
          </div>
        </div>
      </div>
    </footer>

    <!-- Supabase CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
    <script src="supabase-config.js"></script>
    <script src="dashboard.js"></script>
  </body>
</html>
